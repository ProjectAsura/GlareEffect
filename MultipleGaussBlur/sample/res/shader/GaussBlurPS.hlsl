//-------------------------------------------------------------------------------------------------
// File : GaussBlur.hlsl
// Desc : Gauss Blur.
// Copyright(c) Project Asura. All right reserved.
//-------------------------------------------------------------------------------------------------

///////////////////////////////////////////////////////////////////////////////////////////////////
// VSOutput structure
///////////////////////////////////////////////////////////////////////////////////////////////////
struct VSOutput
{
    float4 Position : SV_POSITION;
    float2 TexCoord : TEXCOORD;
};

///////////////////////////////////////////////////////////////////////////////////////////////////
// CBuffer structure
///////////////////////////////////////////////////////////////////////////////////////////////////
cbuffer CbBlur
{
    int     SampleCount : packoffset(c0);
    float4  Offset[16]  : packoffset(c1);
};

//-------------------------------------------------------------------------------------------------
// Textures and Samplers.
//-------------------------------------------------------------------------------------------------
Texture2D       ColorBuffer  : register(t0);
SamplerState    ColorSampler : register(s0);

//-------------------------------------------------------------------------------------------------
//      メインエントリーポイントです.
//-------------------------------------------------------------------------------------------------
float4 main(const VSOutput input) : SV_TARGET0
{
    float4 result = 0;

    for(int i=0; i<SampleCount; ++i)
    { result += Offset[i].z * ColorBuffer.Sample(ColorSampler, input.TexCoord + Offset[i].xy); }

    result.w = 1.0f;

    return result;
}